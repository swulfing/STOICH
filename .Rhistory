knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyverse)
setwd("~/STOICH.Aim1/Data/NLA")
ggplotRegression <- function (fit) {
require(ggplot2)
ggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) +
geom_point() +
stat_smooth(method = "lm", col = "red") +
labs(title = paste("Adj R2 = ",signif(summary(fit)$adj.r.squared, 5),
"Intercept =",signif(fit$coef[[1]],5 ),
" Slope =",signif(fit$coef[[2]], 5),
" P =",signif(summary(fit)$coef[2,4], 5)))
}
test_data <- data.frame(read.csv("ChemData_NLArs2013.csv"))
setwd("~/STOICH.Aim1/Data/NLA")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyverse)
setwd("~/STOICH.Aim1/Code/SWulfing")
ggplotRegression <- function (fit) {
require(ggplot2)
ggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) +
geom_point() +
stat_smooth(method = "lm", col = "red") +
labs(title = paste("Adj R2 = ",signif(summary(fit)$adj.r.squared, 5),
"Intercept =",signif(fit$coef[[1]],5 ),
" Slope =",signif(fit$coef[[2]], 5),
" P =",signif(summary(fit)$coef[2,4], 5)))
}
test_data <- data.frame(read.csv("ChemData_NLArs2013.csv"))
model_2013 <- lm(NITRATE_N_RESULT~DOC_RESULT, data = test_data)
summary(model_2013)
ggplot(test_data) +
geom_point(aes(log(PTL_RESULT), NITRATE_N_RESULT, color = DOC_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
labs(title = "NRSA 2013",
x = "DOC"~(mg~L^-1)) +
ylab(expression(Nitrogen - NO[3]~(mg~L^-1)))
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyverse)
setwd("~/STOICH.Aim1/Code/SWulfing")
ggplotRegression <- function (fit) {
require(ggplot2)
ggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) +
geom_point() +
stat_smooth(method = "lm", col = "red") +
labs(title = paste("Adj R2 = ",signif(summary(fit)$adj.r.squared, 5),
"Intercept =",signif(fit$coef[[1]],5 ),
" Slope =",signif(fit$coef[[2]], 5),
" P =",signif(summary(fit)$coef[2,4], 5)))
}
test_data <- data.frame(read.csv("ChemData_NLArs2013.csv"))
model_2013 <- lm(NITRATE_N_RESULT~DOC_RESULT, data = test_data)
summary(model_2013)
ggplot(test_data) +
geom_point(aes(log(PTL_RESULT), NITRATE_N_RESULT, color = DOC_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
labs(title = "NRSA 2013",
x = "DOC"~(mg~L^-1)) +
ylab(expression(Nitrogen - NO[3]~(mg~L^-1)))
model_2013 <- lm(NITRATE_N_RESULT~DOC_RESULT, data = test_data)
summary(model_2013)
test_dataLOGS <- test_data %>%
mutate(log_Nitrate = log(NITRATE_N_RESULT)) %>%
mutate(log_TP = log(PTL_RESULT)) %>%
mutate(log_DOC = log(DOC_RESULT))
# Duplicate data
test_dataLOGS$log_Nitrate[is.na(test_dataLOGS$log_Nitrate) | test_dataLOGS$log_Nitrate == "-Inf"] <- NA
quantile(test_dataLOGS$DOC_RESULT)
lowDOC_data <- test_data %>%
filter(DOC_RESULT < quantile(test_data$DOC_RESULT)[2])
ggplot(lowDOC_data) +
geom_point(aes(PTL_RESULT, NITRATE_N_RESULT, color = DOC_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
labs(title = "NRSA 2013",
x = "DOC"~(mg~L^-1)) +
ylab(expression(Nitrogen - NO[3]~(mg~L^-1)))
model_2013 <- lm(NITRATE_N_RESULT~DOC_RESULT, data = test_data)
summary(model_2013)
test_dataLOGS <- test_data %>%
mutate(log_Nitrate = log(NITRATE_N_RESULT)) %>%
mutate(log_TP = log(PTL_RESULT)) %>%
mutate(log_DOC = log(DOC_RESULT))
# Duplicate data
test_dataLOGS$log_Nitrate[is.na(test_dataLOGS$log_Nitrate) | test_dataLOGS$log_Nitrate == "-Inf"] <- NA
quantile(test_dataLOGS$DOC_RESULT)
lowDOC_data <- test_data %>%
filter(DOC_RESULT < quantile(test_data$DOC_RESULT)[2])
ggplot(lowDOC_data) +
geom_point(aes(PTL_RESULT, NITRATE_N_RESULT, color = DOC_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
labs(title = "NRSA 2013",
x = "PTL", y = "DOC")
model_2013 <- lm(NITRATE_N_RESULT~DOC_RESULT, data = test_data)
summary(model_2013)
test_dataLOGS <- test_data %>%
mutate(log_Nitrate = log(NITRATE_N_RESULT)) %>%
mutate(log_TP = log(PTL_RESULT)) %>%
mutate(log_DOC = log(DOC_RESULT))
# Duplicate data
test_dataLOGS$log_Nitrate[is.na(test_dataLOGS$log_Nitrate) | test_dataLOGS$log_Nitrate == "-Inf"] <- NA
quantile(test_dataLOGS$DOC_RESULT)
lowDOC_data <- test_data %>%
filter(DOC_RESULT < quantile(test_data$DOC_RESULT)[2])
ggplot(lowDOC_data) +
geom_point(aes(NITRATE_N_RESULT, DOC_RESULT, color = PTL_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
labs(title = "NRSA 2013",
x = "PTL", y = "DOC")
model_2013 <- lm(NITRATE_N_RESULT~DOC_RESULT, data = test_data)
summary(model_2013)
test_dataLOGS <- test_data %>%
mutate(log_Nitrate = log(NITRATE_N_RESULT)) %>%
mutate(log_TP = log(PTL_RESULT)) %>%
mutate(log_DOC = log(DOC_RESULT))
# Duplicate data
test_dataLOGS$log_Nitrate[is.na(test_dataLOGS$log_Nitrate) | test_dataLOGS$log_Nitrate == "-Inf"] <- NA
quantile(test_dataLOGS$DOC_RESULT)
lowDOC_data <- test_data %>%
filter(DOC_RESULT < quantile(test_data$DOC_RESULT)[2])
ggplot(lowDOC_data) +
geom_point(aes(DOC_RESULT, NITRATE_N_RESULT, color = PTL_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
labs(title = "NRSA 2013",
x = "DOC", y = "NITRATE")
model_2013 <- lm(NITRATE_N_RESULT~DOC_RESULT, data = test_data)
summary(model_2013)
test_dataLOGS <- test_data %>%
mutate(log_Nitrate = log(NITRATE_N_RESULT)) %>%
mutate(log_TP = log(PTL_RESULT)) %>%
mutate(log_DOC = log(DOC_RESULT))
# Duplicate data
test_dataLOGS$log_Nitrate[is.na(test_dataLOGS$log_Nitrate) | test_dataLOGS$log_Nitrate == "-Inf"] <- NA
quantile(test_dataLOGS$DOC_RESULT)
lowDOC_data <- test_data %>%
filter(DOC_RESULT < quantile(test_data$DOC_RESULT)[2])
ggplot(test_dataLOGS) +
geom_point(aes(DOC_RESULT, NITRATE_N_RESULT, color = PTL_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
labs(title = "NRSA 2013",
x = "DOC", y = "NITRATE")
ggplot(lowDOC_data) +
geom_point(aes(DOC_RESULT, NITRATE_N_RESULT, color = PTL_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
labs(title = "NRSA 2013",
x = "DOC", y = "NITRATE")
quantile(test_dataLOGS$DOC_RESULT)
model_2013 <- lm(NITRATE_N_RESULT~DOC_RESULT, data = test_data)
summary(model_2013)
test_dataLOGS <- test_data %>%
mutate(log_Nitrate = log(NITRATE_N_RESULT)) %>%
mutate(log_TP = log(PTL_RESULT)) %>%
mutate(log_DOC = log(DOC_RESULT))
# Duplicate data
test_dataLOGS$log_Nitrate[is.na(test_dataLOGS$log_Nitrate) | test_dataLOGS$log_Nitrate == "-Inf"] <- NA
quantile(test_dataLOGS$DOC_RESULT)
lowDOC_data <- test_data %>%
filter(DOC_RESULT < quantile(test_data$DOC_RESULT)[2])
ggplot(test_dataLOGS) +
geom_point(aes(DOC_RESULT, NITRATE_N_RESULT, color = PTL_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
geom_vline(quantile(test_data$DOC_RESULT[2]), linetype, color, size) +
geom_vline(quantile(test_data$DOC_RESULT[3]), linetype, color, size)+
labs(title = "NRSA 2013",
x = "DOC", y = "NITRATE")
model_2013 <- lm(NITRATE_N_RESULT~DOC_RESULT, data = test_data)
summary(model_2013)
test_dataLOGS <- test_data %>%
mutate(log_Nitrate = log(NITRATE_N_RESULT)) %>%
mutate(log_TP = log(PTL_RESULT)) %>%
mutate(log_DOC = log(DOC_RESULT))
# Duplicate data
test_dataLOGS$log_Nitrate[is.na(test_dataLOGS$log_Nitrate) | test_dataLOGS$log_Nitrate == "-Inf"] <- NA
quantile(test_dataLOGS$DOC_RESULT)
lowDOC_data <- test_data %>%
filter(DOC_RESULT < quantile(test_data$DOC_RESULT)[2])
ggplot(test_dataLOGS) +
geom_point(aes(DOC_RESULT, NITRATE_N_RESULT, color = PTL_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
geom_vline(quantile(test_data$DOC_RESULT[2])) +
geom_vline(quantile(test_data$DOC_RESULT[3])) +
labs(title = "NRSA 2013",
x = "DOC", y = "NITRATE")
rlang::last_error()
model_2013 <- lm(NITRATE_N_RESULT~DOC_RESULT, data = test_data)
summary(model_2013)
test_dataLOGS <- test_data %>%
mutate(log_Nitrate = log(NITRATE_N_RESULT)) %>%
mutate(log_TP = log(PTL_RESULT)) %>%
mutate(log_DOC = log(DOC_RESULT))
# Duplicate data
test_dataLOGS$log_Nitrate[is.na(test_dataLOGS$log_Nitrate) | test_dataLOGS$log_Nitrate == "-Inf"] <- NA
quantile(test_dataLOGS$DOC_RESULT)
lowDOC_data <- test_data %>%
filter(DOC_RESULT < quantile(test_data$DOC_RESULT)[2])
ggplot(test_dataLOGS) +
geom_point(aes(DOC_RESULT, NITRATE_N_RESULT, color = PTL_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
geom_vline(quantile(test_data$DOC_RESULT)[2]) +
geom_vline(quantile(test_data$DOC_RESULT)[3]) +
labs(title = "NRSA 2013",
x = "DOC", y = "NITRATE")
model_2013 <- lm(NITRATE_N_RESULT~DOC_RESULT, data = test_data)
summary(model_2013)
test_dataLOGS <- test_data %>%
mutate(log_Nitrate = log(NITRATE_N_RESULT)) %>%
mutate(log_TP = log(PTL_RESULT)) %>%
mutate(log_DOC = log(DOC_RESULT))
# Duplicate data
test_dataLOGS$log_Nitrate[is.na(test_dataLOGS$log_Nitrate) | test_dataLOGS$log_Nitrate == "-Inf"] <- NA
quantile(test_dataLOGS$DOC_RESULT)
lowDOC_data <- test_data %>%
filter(DOC_RESULT < quantile(test_data$DOC_RESULT)[2])
ggplot(test_dataLOGS) +
geom_point(mapping = aes(DOC_RESULT, NITRATE_N_RESULT, color = PTL_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
geom_vline(quantile(test_data$DOC_RESULT[2])) +
geom_vline(quantile(test_data$DOC_RESULT[3])) +
labs(title = "NRSA 2013",
x = "DOC", y = "NITRATE")
model_2013 <- lm(NITRATE_N_RESULT~DOC_RESULT, data = test_data)
summary(model_2013)
test_dataLOGS <- test_data %>%
mutate(log_Nitrate = log(NITRATE_N_RESULT)) %>%
mutate(log_TP = log(PTL_RESULT)) %>%
mutate(log_DOC = log(DOC_RESULT))
# Duplicate data
test_dataLOGS$log_Nitrate[is.na(test_dataLOGS$log_Nitrate) | test_dataLOGS$log_Nitrate == "-Inf"] <- NA
quantile(test_dataLOGS$DOC_RESULT)
lowDOC_data <- test_data %>%
filter(DOC_RESULT < quantile(test_data$DOC_RESULT)[2])
ggplot(test_dataLOGS) +
geom_point(aes(DOC_RESULT, NITRATE_N_RESULT, color = PTL_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
geom_vline(mapping = NULL, quantile(test_data$DOC_RESULT[2])) +
geom_vline(mapping = NULL, quantile(test_data$DOC_RESULT[3])) +
labs(title = "NRSA 2013",
x = "DOC", y = "NITRATE")
quantile(test_data$DOC_RESULT)[2])
quantile(test_data$DOC_RESULT)[2]
class(quantile(test_data$DOC_RESULT)[2])
as.numeric(quantile(test_data$DOC_RESULT)[2])
model_2013 <- lm(NITRATE_N_RESULT~DOC_RESULT, data = test_data)
summary(model_2013)
test_dataLOGS <- test_data %>%
mutate(log_Nitrate = log(NITRATE_N_RESULT)) %>%
mutate(log_TP = log(PTL_RESULT)) %>%
mutate(log_DOC = log(DOC_RESULT))
# Duplicate data
test_dataLOGS$log_Nitrate[is.na(test_dataLOGS$log_Nitrate) | test_dataLOGS$log_Nitrate == "-Inf"] <- NA
quantile(test_dataLOGS$DOC_RESULT)
lowDOC_data <- test_data %>%
filter(DOC_RESULT < quantile(test_data$DOC_RESULT)[2])
ggplot(test_dataLOGS) +
geom_point(aes(DOC_RESULT, NITRATE_N_RESULT, color = PTL_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
geom_vline(mapping = NULL, as.numeric(quantile(test_data$DOC_RESULT)[2])) +
geom_vline(mapping = NULL, as.numeric(quantile(test_data$DOC_RESULT)[3])) +
labs(title = "NRSA 2013",
x = "DOC", y = "NITRATE")
model_2013 <- lm(NITRATE_N_RESULT~DOC_RESULT, data = test_data)
summary(model_2013)
test_dataLOGS <- test_data %>%
mutate(log_Nitrate = log(NITRATE_N_RESULT)) %>%
mutate(log_TP = log(PTL_RESULT)) %>%
mutate(log_DOC = log(DOC_RESULT))
# Duplicate data
test_dataLOGS$log_Nitrate[is.na(test_dataLOGS$log_Nitrate) | test_dataLOGS$log_Nitrate == "-Inf"] <- NA
quantile(test_dataLOGS$DOC_RESULT)
lowDOC_data <- test_data %>%
filter(DOC_RESULT < quantile(test_data$DOC_RESULT)[2])
ggplot(test_dataLOGS) +
geom_point(aes(DOC_RESULT, NITRATE_N_RESULT, color = PTL_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
geom_vline(mapping = NULL, as.data.frame(quantile(test_data$DOC_RESULT)[2])) +
# geom_vline(mapping = NULL, as.numeric(quantile(test_data$DOC_RESULT)[3])) +
labs(title = "NRSA 2013",
x = "DOC", y = "NITRATE")
q1 <- quantile(test_data$DOC_RESULT)[2])
q1 <- quantile(test_data$DOC_RESULT)[2]
q2 <- quantile(test_data$DOC_RESULT)[3]
model_2013 <- lm(NITRATE_N_RESULT~DOC_RESULT, data = test_data)
summary(model_2013)
test_dataLOGS <- test_data %>%
mutate(log_Nitrate = log(NITRATE_N_RESULT)) %>%
mutate(log_TP = log(PTL_RESULT)) %>%
mutate(log_DOC = log(DOC_RESULT))
# Duplicate data
test_dataLOGS$log_Nitrate[is.na(test_dataLOGS$log_Nitrate) | test_dataLOGS$log_Nitrate == "-Inf"] <- NA
quantile(test_dataLOGS$DOC_RESULT)
q1 <- quantile(test_data$DOC_RESULT)[2]
q2 <- quantile(test_data$DOC_RESULT)[3]
lowDOC_data <- test_data %>%
filter(DOC_RESULT < quantile(test_data$DOC_RESULT)[2])
ggplot(test_dataLOGS) +
geom_point(aes(DOC_RESULT, NITRATE_N_RESULT, color = PTL_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
geom_vline(q1) +
geom_vline(q2) +
labs(title = "NRSA 2013",
x = "DOC", y = "NITRATE")
model_2013 <- lm(NITRATE_N_RESULT~DOC_RESULT, data = test_data)
summary(model_2013)
test_dataLOGS <- test_data %>%
mutate(log_Nitrate = log(NITRATE_N_RESULT)) %>%
mutate(log_TP = log(PTL_RESULT)) %>%
mutate(log_DOC = log(DOC_RESULT))
# Duplicate data
test_dataLOGS$log_Nitrate[is.na(test_dataLOGS$log_Nitrate) | test_dataLOGS$log_Nitrate == "-Inf"] <- NA
quantile(test_dataLOGS$DOC_RESULT)
q1 <- quantile(test_data$DOC_RESULT)[2]
q2 <- quantile(test_data$DOC_RESULT)[3]
lowDOC_data <- test_data %>%
filter(DOC_RESULT < quantile(test_data$DOC_RESULT)[2])
p <- ggplot(test_dataLOGS) +
geom_point(aes(DOC_RESULT, NITRATE_N_RESULT, color = PTL_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
labs(title = "NRSA 2013",
x = "DOC", y = "NITRATE")
p +   geom_vline(q1) + geom_vline(q2)
model_2013 <- lm(NITRATE_N_RESULT~DOC_RESULT, data = test_data)
summary(model_2013)
test_dataLOGS <- test_data %>%
mutate(log_Nitrate = log(NITRATE_N_RESULT)) %>%
mutate(log_TP = log(PTL_RESULT)) %>%
mutate(log_DOC = log(DOC_RESULT))
# Duplicate data
test_dataLOGS$log_Nitrate[is.na(test_dataLOGS$log_Nitrate) | test_dataLOGS$log_Nitrate == "-Inf"] <- NA
quantile(test_dataLOGS$DOC_RESULT)
q1 <- quantile(test_data$DOC_RESULT)[2]
q2 <- quantile(test_data$DOC_RESULT)[3]
lowDOC_data <- test_data %>%
filter(DOC_RESULT < quantile(test_data$DOC_RESULT)[2])
p <- ggplot(test_dataLOGS) +
geom_point(aes(DOC_RESULT, NITRATE_N_RESULT, color = PTL_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
labs(title = "NRSA 2013",
x = "DOC", y = "NITRATE")
p
model_2013 <- lm(NITRATE_N_RESULT~DOC_RESULT, data = test_data)
summary(model_2013)
test_dataLOGS <- test_data %>%
mutate(log_Nitrate = log(NITRATE_N_RESULT)) %>%
mutate(log_TP = log(PTL_RESULT)) %>%
mutate(log_DOC = log(DOC_RESULT))
# Duplicate data
test_dataLOGS$log_Nitrate[is.na(test_dataLOGS$log_Nitrate) | test_dataLOGS$log_Nitrate == "-Inf"] <- NA
quantile(test_dataLOGS$DOC_RESULT)
q1 <- quantile(test_data$DOC_RESULT)[2]
q2 <- quantile(test_data$DOC_RESULT)[3]
lowDOC_data <- test_data %>%
filter(DOC_RESULT < quantile(test_data$DOC_RESULT)[2])
p <- ggplot(test_dataLOGS) +
geom_point(aes(DOC_RESULT, NITRATE_N_RESULT, color = PTL_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
labs(title = "NRSA 2013",
x = "DOC", y = "NITRATE")
p + geom_vline(aes(q1)) + geom_vline(aes(q2))
model_2013 <- lm(NITRATE_N_RESULT~DOC_RESULT, data = test_data)
summary(model_2013)
test_dataLOGS <- test_data %>%
mutate(log_Nitrate = log(NITRATE_N_RESULT)) %>%
mutate(log_TP = log(PTL_RESULT)) %>%
mutate(log_DOC = log(DOC_RESULT))
# Duplicate data
test_dataLOGS$log_Nitrate[is.na(test_dataLOGS$log_Nitrate) | test_dataLOGS$log_Nitrate == "-Inf"] <- NA
quantile(test_dataLOGS$DOC_RESULT)
q1 <- quantile(test_data$DOC_RESULT)[2]
q2 <- quantile(test_data$DOC_RESULT)[3]
lowDOC_data <- test_data %>%
filter(DOC_RESULT < quantile(test_data$DOC_RESULT)[2])
p <- ggplot(test_dataLOGS) +
geom_point(aes(DOC_RESULT, NITRATE_N_RESULT, color = PTL_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
labs(title = "NRSA 2013",
x = "DOC", y = "NITRATE")
p + geom_vline(aes(xintercept = q1)) + geom_vline(aes(xintercept = q2))
ggplot(lowDOC_data) +
geom_point(aes(DOC_RESULT, NITRATE_N_RESULT, color = PTL_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
labs(title = "NRSA 2013",
x = "DOC", y = "NITRATE")
model_2013 <- lm(NITRATE_N_RESULT~DOC_RESULT, data = test_data)
summary(model_2013)
test_dataLOGS <- test_data %>%
mutate(log_Nitrate = log(NITRATE_N_RESULT)) %>%
mutate(log_TP = log(PTL_RESULT)) %>%
mutate(log_DOC = log(DOC_RESULT))
# Duplicate data
test_dataLOGS$log_Nitrate[is.na(test_dataLOGS$log_Nitrate) | test_dataLOGS$log_Nitrate == "-Inf"] <- NA
quantile(test_dataLOGS$DOC_RESULT)
q1 <- quantile(test_data$DOC_RESULT)[2]
q2 <- quantile(test_data$DOC_RESULT)[4]
lowDOC_data <- test_data %>%
filter(DOC_RESULT < quantile(test_data$DOC_RESULT)[2])
p <- ggplot(test_dataLOGS) +
geom_point(aes(DOC_RESULT, NITRATE_N_RESULT, color = PTL_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
labs(title = "NRSA 2013",
x = "DOC", y = "NITRATE")
p + geom_vline(aes(xintercept = q1)) + geom_vline(aes(xintercept = q2))
ggplot(lowDOC_data) +
geom_point(aes(DOC_RESULT, NITRATE_N_RESULT, color = PTL_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
labs(title = "NRSA 2013",
x = "DOC", y = "NITRATE")
quantile(test_dataLOGS$DOC_RESULT)
model_2013 <- lm(NITRATE_N_RESULT~DOC_RESULT, data = test_data)
summary(model_2013)
test_dataLOGS <- test_data %>%
mutate(log_Nitrate = log(NITRATE_N_RESULT)) %>%
mutate(log_TP = log(PTL_RESULT)) %>%
mutate(log_DOC = log(DOC_RESULT))
# Duplicate data
test_dataLOGS$log_Nitrate[is.na(test_dataLOGS$log_Nitrate) | test_dataLOGS$log_Nitrate == "-Inf"] <- NA
quantile(test_dataLOGS$DOC_RESULT)
q1 <- quantile(test_data$DOC_RESULT)[4]
q2 <- quantile(test_data$DOC_RESULT)[5]
lowDOC_data <- test_data %>%
filter(DOC_RESULT < quantile(test_data$DOC_RESULT)[2])
p <- ggplot(test_dataLOGS) +
geom_point(aes(DOC_RESULT, NITRATE_N_RESULT, color = PTL_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
labs(title = "NRSA 2013",
x = "DOC", y = "NITRATE")
p + geom_vline(aes(xintercept = q1)) + geom_vline(aes(xintercept = q2))
ggplot(lowDOC_data) +
geom_point(aes(DOC_RESULT, NITRATE_N_RESULT, color = PTL_RESULT * 1000)) +
scale_color_viridis_c("TP"~(mu~g~L^-1)) +
theme_bw() +
labs(title = "NRSA 2013",
x = "DOC", y = "NITRATE")
library(tidyverse)
library(MetBrewer)
install.packages("MetBrewer")
library(tidyverse)
library(MetBrewer)
library(sf)
library(ggspatial)
library(raster)
library(rnaturalearth)
library(rgeos)
library(tidyverse)
library(MetBrewer)
library(sf)
library(ggspatial)
library(raster)
library(rnaturalearth)
library(rgeos)
setwd("~/STOICH.Aim1")
source("Code/masterData.R")
getwd()
setwd("C:/Users/sophi/Documents/STOICH_Aim1")
